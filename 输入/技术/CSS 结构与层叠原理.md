# CSS 结构与层叠原理

* 继承是从一个元素向后代元素传递属性值所采用的机制。
* 在确定一个元素应用哪些值时，浏览器考虑以下因素
	* 特殊性（权重）
	* 声明来源（层叠）
	* 继承

## 特殊性

* 特殊性值表述为4个部分：0， 0， 0， 0
* 对于ID属性值，加 0，1，0，0
* 对于各类属性值、属性选择或伪类，加 0，0，1，0
* 对于元素选择和伪元素，加 0，0，0，1
* 结合符和通配选择器对特殊性没有任何贡献，他们的为的特殊性是0,0,0,0

### 声明和特殊性

* 由于特殊性的缘故，浏览器必须将CSS规则“解组”为单独的规则。

### ID和属性选择器的特殊性

* ID选择器和指定id属性的属性选择器在特殊性上有所不同。例如：
	* tr[id="demo"]
	* tr#demo (它将胜出)

### 内联样式特殊性

* 内联样式的特殊性贡献值为 1,0,0,0

### 重要性

* 重要声明的特殊性超过其他所有声明，在规则声明的结束分号前加`!important`
* 重要声明的特殊性冲突会在重要声明内部解决，而不会与非重要声明相混。
* 如果一个重要声明与一个非重要声明冲突，胜出的总是重要声明。

<hr>

## 继承
* 基于继承机制，样式不仅应用到指定的元素，还会应用到它的后代元素。
* 在HTML上，沿着文档树向上传播样式的只有一个例外：应用到`body`元素的背景样式可以传递到`html`元素。
* 大多数框模型属性（内外边距、边框、背景）都不能继承
* 继承的值没有特殊性，甚至连0特殊性都没有，而0特殊性比无特殊性强。比如通配选择器的特殊性为0,0,0,0，某个元素自身设置了颜色而子元素没有设置颜色，则被通配选择器命中的子元素可能应用通配选择器设置的颜色不是继承其父元素的颜色，这种效果叫做【短路继承】。

<hr>

## 层叠

* 层叠规则
	1. 找出所有规则，这些规则都包含与一个给定元素匹配的选择器
	2. 按显示权重对应用到该元素的所有声明排序。
		1. 重要声明权重高于非重要声明
	3. 按来源给应用到给定元素的所有声明排序。
		1. 来源有三种：作者声明（程序员），读者声明（用户），用户代理声明（浏览器）
		2. 作者声明 > 读者声明
		3. 重要读者声明 > 所有其他样式（包括重要作者声明）
		4. 作者声明和读者声明 > 用户代理声明
	4. 按特殊性对应用到给定元素的所有声明排序。
	5. 按出现顺序对应用到给定元素的所有声明培训。

### 非CSS表现提示
	
* 文档中包含的非CSS的表现提示（如`font`元素），其特殊性将被处理为0. 
* 它可以被读者声明或作者声明覆盖，但无法被用户代理声明覆盖。